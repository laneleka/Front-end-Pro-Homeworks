{"version":3,"file":"script.js","sources":["script.js"],"sourcesContent":["const USER_KEY_LS = 'user';\nconst USERS_KEY_LS = 'users';\nconst PRODUCTS_KEY_LS = 'products';\nconst ROUTES = {\n  '/': initProductsPage,\n  '/index.html': initProductsPage,\n  '/login.html': initLoginPage,\n  '/shoppingCart.html': initShoppingCartPage,\n  '/account.html': initAccountPage,\n}\n\nconst fulfillProducts = (user, items = user.shoppingCart) => {\n  const products = getLocalStorage(PRODUCTS_KEY_LS);\n\n  return items.map((item) => {\n    const foundProduct = products.find(product => product.id === item.id);\n    foundProduct.count = item.count;\n    return foundProduct;\n  });\n}\n\nconst createProductElement = (product) => {\n  const productElement = new Element('div', { attributes: {'data-id': product.id }, classes: 'product' });\n  const user = getLocalStorage(USER_KEY_LS);\n\n  productElement.setHTML(`\n        <img src=\"images/products/${product.img}.png\" class=\"product__img\" alt=${product.title} height=\"80\">\n        <p class=\"product__title\">${product.title}</p>\n        ${product.sale ? `<div class=\"product__sale\">\n            <span class=\"product__sale--old\">$${product.price}</span>\n            <span class=\"product__sale--percent\">-${product.salePercent}%</span>\n        </div>` : ''}\n        <div class=\"product__info\">\n            <span class=\"product__price\">$${product.sale ? getSalePrice(product.price, product.salePercent) : product.price}</span>\n            <button class=\"product__cart ${user?.shoppingCart?.some(shopItem => shopItem.id === product.id) ? 'product__cart--in' : ''}\">\n                <img src=\"images/shopping-cart.png\" alt=\"shopping cart\" height=\"20\">\n            </button>\n        </div>\n    `);\n\n  return productElement;\n}\n\nconst updateShoppingSum = (shoppingCart) => {\n  const shoppingSumElement = document.querySelector('#orderSummaryTotal');\n  shoppingSumElement.innerHTML = `$${shoppingCart.reduce((acc, item) => acc + getCountPrice(item), 0)}`;\n}\n\nconst createCategoryElement = (category) => {\n  const categoryElement = new Element('section', { classes: 'category', attributes: { 'data-category': category } });\n  categoryElement.setHTML(`<h2>${category}</h2><div class=\"category__container\"></div>`);\n  return categoryElement;\n}\n\nconst createRowOrderElement = (order) => {\n  const rowElement = new Element('tr', { attributes: { 'data-id': order.id } });\n\n  rowElement.setHTML(`\n                <td>\n                  <div class=\"item__info\">\n                    <img src=\"images/products/${order.img}.png\" alt=\"Bus\" height=\"100\" />\n                    <div>\n                      <p class=\"item__info--title\">${order.title}</p>\n                    </div>\n                  </div>\n                </td>\n                <td>$${order.price}</td>\n                <td>${order.sale ? `<span class=\"item__sale\">- ${order.salePercent}%</span>` : ''}</td>\n                <td>${order.count}</td>\n                <td>$${getCountPrice(order)}</td>\n                `);\n\n  return rowElement;\n}\n\nconst createRowShoppingElement = (product) => {\n  const rowElement = new Element('tr', { attributes: { 'data-id': product.id } });\n\n  rowElement.setHTML(`\n                <td>\n                  <div class=\"item__info\">\n                    <img\n                      src=\"images/products/${product.img}.png\"\n                      alt=\"Boat\"\n                      height=\"100\"\n                    />\n                    <div>\n                      <p class=\"item__info--title\">${product.title}</p>\n                    </div>\n                  </div>\n                </td>\n                <td>$${product.price}</td>\n                <td>${product.sale ? `<span class=\"item__sale\">- ${product.salePercent}%</span>` : ''}</td>\n                <td><input type=\"number\" value=\"${product.count}\" /></td>\n                \n                <td class=\"item__price-with-count\">$${getCountPrice(product)}</td>\n                <td>\n                  <button class=\"item__remove\">\n                    <img src=\"images/delete.png\" alt=\"delete\" height=\"20\" />\n                  </button>\n                </td>\n    `);\n\n  return rowElement;\n}\n\nconst updateHeaderCount = (count) => {\n  const cartCount = document.querySelector('#headerShoppingCartCount');\n  cartCount.innerHTML = count;\n}\n\nconst handleLogout = async () => {\n  const usersService = new UsersService();\n  const user = getLocalStorage(USER_KEY_LS);\n  await usersService.update({ id: user.id, status: false });\n  removeLocalStorage(USER_KEY_LS);\n  window.location.href = '/';\n}\n\nconst updateHeader = (user) => {\n  const headerUserElement = document.querySelector('#headerUser');\n  const headerLogoutElement = document.querySelector('#headerLogout');\n  const shoppingCartElement = document.querySelector('#headerShoppingCart');\n\n  if (user?.status) {\n    headerLogoutElement.classList.add('active');\n    headerUserElement.innerHTML = user.name;\n    headerUserElement.setAttribute('href', 'account.html');\n    shoppingCartElement.setAttribute('href', 'shoppingCart.html');\n    updateHeaderCount(user.shoppingCart.length);\n\n    headerLogoutElement.addEventListener('click', handleLogout);\n  } else {\n    headerLogoutElement.classList.remove('active');\n    headerUserElement.innerHTML = 'Log in';\n    headerUserElement.setAttribute('href', 'login.html');\n    shoppingCartElement.setAttribute('href', 'login.html');\n    updateHeaderCount(0);\n\n    headerLogoutElement.removeEventListener('click', handleLogout);\n  }\n}\n\nconst initHeader = () => {\n  const users = getLocalStorage(USERS_KEY_LS);\n  const currentUser = getLocalStorage(USER_KEY_LS);\n  const user = users.find(user => user.email === currentUser?.email);\n\n  if (user) {\n    setLocalStorage(USER_KEY_LS, user);\n  }\n\n  updateHeader(user);\n}\n\nconst setFormError = (formElement, error) => {\n  const errorElement = formElement.querySelector('.error');\n  errorElement.innerHTML = error;\n  errorElement.classList.add('active');\n}\n\nasync function initProductsPage(usersService) {\n  const products = getLocalStorage(PRODUCTS_KEY_LS);\n  const groupedProducts = groupedByCategory(products);\n\n  const categoryContainerElement = new Element('div', { classes: 'container', attributes: { 'id': 'categoriesContainer' } });\n  render('main', categoryContainerElement.element);\n\n  Object.keys(groupedProducts).forEach(category => {\n    const categoryElement = createCategoryElement(category);\n\n    render('#categoriesContainer', categoryElement.element);\n    render(`[data-category=\"${category}\"] .category__container`,\n      groupedProducts[category].map(product => createProductElement(product).element));\n  });\n\n  document.addEventListener('click', async (event) => {\n    const user = getLocalStorage(USER_KEY_LS);\n\n    if (event.target.closest('.product__cart')) {\n      if (!user?.status) {\n        window.location.href = 'login.html';\n        return;\n      }\n\n      const product = products.find(product => product.id === event.target.closest('.product').dataset.id);\n      const shoppingCart = user.shoppingCart;\n      const productInCart = shoppingCart.find(shopItem => shopItem.id === product.id);\n\n      if (productInCart) {\n        shoppingCart.splice(shoppingCart.indexOf(productInCart), 1);\n      } else {\n        shoppingCart.push({\n          id: product.id,\n          count: 1,\n        });\n      }\n\n      const updatedUser = await usersService.update({ ...user, shoppingCart });\n      setLocalStorage(USER_KEY_LS, updatedUser);\n\n      event.target.closest('.product__cart').classList.toggle('product__cart--in');\n      updateHeader(user);\n    }\n  });\n}\n\nasync function initLoginPage(usersService) {\n  const loginFormElement = document.querySelector('#loginForm');\n  const registrationFormElement = document.querySelector('#registrationForm');\n\n  loginFormElement.addEventListener('submit', async (event) => {\n    event.preventDefault();\n    const form = new FormData(event.currentTarget);\n    const users = getLocalStorage(USERS_KEY_LS);\n\n    const foundUser = users.find(user => user.email === form.get('email'));\n\n    if (!foundUser) {\n      setFormError(loginFormElement, 'Invalid email');\n      return;\n    }\n\n    if (!users.some(user => user.password === form.get('password') && user.email === foundUser.email)) {\n      setFormError(loginFormElement, 'Invalid password');\n      return;\n    }\n\n    await usersService.update({ ...foundUser, status: true });\n    setLocalStorage(USER_KEY_LS, foundUser);\n    window.location.href = '/';\n  });\n\n  registrationFormElement.addEventListener('submit', async (event) => {\n    event.preventDefault();\n\n    const form = new FormData(event.currentTarget);\n    const users = getLocalStorage(USERS_KEY_LS);\n\n    if (users.find(user => user.email === form.get('email'))) {\n      setFormError(registrationFormElement, 'User with this email already exists');\n      return;\n    }\n\n    if (form.get('password') !== form.get('passwordVerify')) {\n      setFormError(registrationFormElement, 'Passwords do not match');\n      return;\n    }\n\n    const createdUser = await usersService.create({\n      name: form.get('name'),\n      email: form.get('email'),\n      password: form.get('password'),\n      status: true\n    });\n\n    setLocalStorage(USER_KEY_LS, createdUser);\n    window.location.href = '/';\n  });\n}\n\nasync function initAccountPage(usersService) {\n  const user = getLocalStorage(USER_KEY_LS);\n\n  if (!user) {\n    window.location.href = 'login.html';\n    return;\n  }\n\n  const userInfoNameElement = document.querySelector('#userInfoName');\n  const userInfoEmailElement = document.querySelector('#userInfoEmail');\n  const deleteAcc = document.querySelector('#deleteAcc');\n\n  userInfoNameElement.innerHTML = user.name;\n  userInfoEmailElement.innerHTML = user.email;\n\n  deleteAcc.addEventListener('click', async () => {\n    await usersService.deleteUser(user.id);\n    await handleLogout();\n  });\n\n  const orders = fulfillProducts(user, user.orders);\n\n  orders.forEach(order => {\n    render('#orderTable tbody', createRowOrderElement(order).element);\n  });\n}\n\nasync function initShoppingCartPage(usersService) {\n  const user = getLocalStorage(USER_KEY_LS);\n\n  if (!user?.status) {\n    window.location.href = 'login.html';\n    return;\n  }\n\n  const shoppingCart = fulfillProducts(user);\n\n  updateShoppingSum(shoppingCart);\n\n  shoppingCart.forEach(product => {\n    const productElement = createRowShoppingElement(product);\n    render('#shoppingCartTable tbody', productElement.element);\n  });\n\n  const table = document.querySelector('#shoppingCartTable');\n\n  table.addEventListener('click', async (event) => {\n    if (event.target.closest('.item__remove')) {\n      const user = getLocalStorage(USER_KEY_LS);\n      const productId = event.target.closest('tr').dataset.id;\n      const filteredShoppingCart = shoppingCart\n        .filter(product => product.id !== productId)\n        .map((shoppingCartItem) => ({ id: shoppingCartItem.id, count: shoppingCartItem.count }));\n\n      const updatedUser = await usersService.update({ ...user, shoppingCart: filteredShoppingCart });\n      setLocalStorage(USER_KEY_LS, updatedUser);\n\n      const updatedShoppingCart = fulfillProducts(updatedUser);\n\n      updateShoppingSum(updatedShoppingCart);\n      updateHeaderCount(updatedShoppingCart.length);\n      event.target.closest('tr').remove();\n    }\n  });\n\n  table.addEventListener('input', async (event) => {\n    const user = getLocalStorage(USER_KEY_LS);\n    const productId = event.target.closest('tr').dataset.id;\n\n    const shoppingCart = fulfillProducts(user);\n\n    const product = shoppingCart.find(shoppingCartItem => shoppingCartItem.id === productId);\n\n    if (!product) {\n      return;\n    }\n\n    const count = event.target.value;\n    user.shoppingCart.splice(shoppingCart.indexOf(product), 1, { id: product.id, count: +count });\n    const updatedUser = await usersService.update({ ...user, shoppingCart: user.shoppingCart });\n\n    setLocalStorage(USER_KEY_LS, updatedUser);\n\n    const updatedShoppingCart = fulfillProducts(user);\n\n    updateShoppingSum(updatedShoppingCart);\n    document.querySelector(`#shoppingCartTable [data-id=\"${product.id}\"] .item__price-with-count`).innerHTML =\n      `$${getCountPrice({ ...product, count: +count })}`;\n  });\n\n  const ordersForm = document.querySelector('#orderSummary');\n\n  ordersForm.addEventListener('submit', async (event) => {\n    event.preventDefault();\n    const user = getLocalStorage(USER_KEY_LS);\n    const shoppingCart = user.shoppingCart.map((shoppingCartItem) => ({ id: shoppingCartItem.id, count: shoppingCartItem.count }));\n    const orders = [];\n\n    const restOrders = user.orders.filter(order => !shoppingCart.find(shoppingCartItem => shoppingCartItem.id === order.id));\n\n    shoppingCart.forEach(shoppingCartItem => {\n      const order = user.orders.find(order => order.id === shoppingCartItem.id);\n\n      if (order) {\n        order.count = +order.count + +shoppingCartItem.count;\n        orders.push(order);\n      } else {\n        orders.push(shoppingCartItem);\n      }\n    });\n\n    const updatedUser = await usersService.update({\n      ...user,\n      shoppingCart: [],\n      orders: [...orders, ...restOrders]\n    });\n\n    setLocalStorage(USER_KEY_LS, updatedUser);\n    updateHeaderCount(0);\n    window.location.href = 'account.html';\n  });\n}\n\ndocument.addEventListener('DOMContentLoaded', async () => {\n  const usersService = new UsersService();\n  const productService = new ProductService();\n  const users = await usersService.getAll();\n  const products = await productService.getAll();\n\n  setLocalStorage(USERS_KEY_LS, users);\n  setLocalStorage(PRODUCTS_KEY_LS, products);\n\n  initHeader();\n\n  ROUTES[window.location.pathname] && ROUTES[window.location.pathname](usersService);\n});\n"],"names":["USER_KEY_LS","USERS_KEY_LS","PRODUCTS_KEY_LS","ROUTES","/","initProductsPage","/index.html","/login.html","initLoginPage","/shoppingCart.html","initShoppingCartPage","/account.html","initAccountPage","fulfillProducts","user","items","shoppingCart","products","getLocalStorage","map","foundProduct","find","product","id","item","count","createProductElement","productElement","Element","attributes","data-id","classes","setHTML","img","title","sale","price","salePercent","getSalePrice","some","shopItem","updateShoppingSum","document","querySelector","innerHTML","reduce","acc","getCountPrice","createCategoryElement","categoryElement","data-category","category","createRowOrderElement","rowElement","order","createRowShoppingElement","updateHeaderCount","handleLogout","async","usersService","UsersService","await","update","status","removeLocalStorage","window","location","href","updateHeader","headerUserElement","headerLogoutElement","shoppingCartElement","classList","add","name","setAttribute","length","addEventListener","remove","removeEventListener","initHeader","users","currentUser","email","setLocalStorage","setFormError","formElement","error","errorElement","groupedProducts","groupedByCategory","categoryContainerElement","render","element","Object","keys","forEach","event","target","closest","dataset","productInCart","updatedUser","splice","indexOf","push","toggle","loginFormElement","registrationFormElement","preventDefault","form","FormData","currentTarget","foundUser","get","password","createdUser","create","userInfoNameElement","userInfoEmailElement","deleteAcc","deleteUser","orders","table","productId","filteredShoppingCart","filter","shoppingCartItem","updatedShoppingCart","value","restOrders","productService","ProductService","getAll","pathname"],"mappings":"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"}